<!DOCTYPE html>
<html lang="en">

<head>
  <title>Login</title>
  <!-- CSS only -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <style>
    .hidden {
      display: none;
    }

    .show {
      display: block;
    }
  </style>
</head>

<body class="container">

  <main>
    <h1 class="mb-5 mt-3 text-center">Login</h1>
    <form id="form" class="mb-3">
      <div class="form-group">
        <label for="exampleInputEmail1">Email address</label>
        <input type="email" id="email" name="email" class="form-control" id="exampleInputEmail1"
          aria-describedby="emailHelp" placeholder="Enter email">
      </div>
      <div class="form-group">
        <label for="exampleInputPassword1">Password</label>
        <input type="password" id="password" name="password" class="form-control" id="exampleInputPassword1"
          placeholder="Password">
      </div>

      <button type="submit" class="btn btn-primary mt-2">Submit</button>
    </form>
    <p class="text-success noti" id="message"></p>
    <p class="text-primary noti" id="token"></p>
  </main>

  <script>
    const form = document.getElementById('form');
    const email = document.getElementById('email');
    const password = document.getElementById('password');
    const message = document.getElementById('message');
    const token = document.getElementById('token');
    const hiddens = document.querySelectorAll('.noti');

    form.onsubmit = function (e) {
      e.preventDefault();
      hiddens.forEach(item => item.classList.add('hidden'))
      fetch('/api/v1/auth/login', {
        method: 'post',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          email: email.value,
          password: password.value
        })
      }).then(res => res.json()).then(data => {
        const { token: accessToken } = data;

        const { success } = data;
        if (success) {
          message.innerText = 'Đăng nhập thành công';
          token.innerText = `Access token: ${accessToken}`;
          hiddens.forEach(item => item.classList.add('show'))
          hiddens.forEach(item => item.classList.remove('hidden'))
        }
        else {
          token.innerText = '';
          const { error } = data;
          message.innerText = error;
          hiddens.forEach(item => item.classList.add('show'))
          hiddens.forEach(item => item.classList.remove('hidden'))
        }

      }).catch(err => alert(err.message))
    }
  </script>

</body>

</html>